/**
 * Implementation library for e-Retail DX
 * --------------------------------------
 * For Amadeus usage only. Usage of methods by any other party is discouraged and not supported.
 * 
 * @copyright Amadeus Implementation Team
 */
function IMPLibDxCore(){var e=this;this.VERSION="1.16",this.JSON_READY_EVENT="plnext:customData:ready",this.BY_DEPARTURE_COUNTRY="BY_DEPARTURE_COUNTRY",this.BY_CURRENCY="BY_CURRENCY",this.BY_INITIAL_OFFICE_CITY="BY_INITIAL_OFFICE_CITY",this.BY_INITIAL_OFFICE_ID="BY_INITIAL_OFFICE_ID",this.officeIdMapping=new Array,this.posMapping=new Array,this.deployedLibs=null,this.debug=function(e){window.console&&window.console.log&&window.console.log(e)},this.warn=function(e){window.console&&window.console.warn&&window.console.warn(e)},this.i18n=function(t){var n=e.getLanguage();return""==n&&(n="GB"),n in t?t[n]:t.GB},this.updateDom=function(t,n,i,o,r){var s=i||1e3,a=o||5,u=r||0;jQuery(t).length>0?"function"==typeof n&&n(t):u<a?(e.debug("Wait for loading of "+t),setTimeout(function(){e.updateDom(t,n,s,a,u+1)},s)):e.debug("Maximum iteration reached but element "+t+" not loaded on the page")},this.isCustomJavascriptEnabled=function(){var t=!0;try{window.location.href.match(/(\?|&)enableCustomJs=true(&|$)/i)?(t=!0,sessionStorage.setItem("implibdx.core.enableCustomJs",!0)):window.location.href.match(/(\?|&)enableCustomJs=false(&|$)/i)?(t=!1,sessionStorage.setItem("implibdx.core.enableCustomJs",!1)):sessionStorage.getItem("implibdx.core.enableCustomJs")&&(t=sessionStorage.getItem("implibdx.core.enableCustomJs"))}catch(n){e.debug("session storage not available")}return t},this.getDeployedLibs=function(){if(null==e.deployedLibs){e.deployedLibs={};for(key in implibdx)implibdx.hasOwnProperty(key)&&implibdx[key].VERSION&&(e.deployedLibs[key]=implibdx[key].VERSION)}return e.deployedLibs},this.isTestEnvironment=function(){return"undefined"==typeof this._isTestEnvironment&&(this._isTestEnvironment=window.location.hostname.indexOf("wav.")>=0),this._isTestEnvironment},this.hideWarning7127=function(){plnextv2.utils.ImplementationUtils.removeError&&(plnextv2.utils.ImplementationUtils.removeError("7127","W"),plnextv2.utils.ImplementationUtils.removeError(7127,"W"))},this.getExternalId=function(){var e=this.getJson();if(null!=e&&"undefined"!=typeof e.external_id)return e.external_id;try{var t=plnextv2.utils.context.AppContext.getAppData().requestParameters;if("undefined"!=typeof t.EXTERNAL_ID)return t.EXTERNAL_ID}catch(n){}return""},this.getSessionId=function(){return plnextv2.utils.requestManager.PlnextRequestManager.getSessionId()},this.getJson=function(){return"undefined"!=typeof eBaDataLayer?eBaDataLayer:null},this.getLanguage=function(){var e=this.getJson();return null!=e&&e.language?e.language.toUpperCase():""},this.getPage=function(){try{return plnextv2.utils.context.AppContext.getPageId().toLowerCase()}catch(t){e.warn("something goes wrong")}return""},this.getEmail=function(){var t=e.getPageData();return t&&t.business&&t.business.FareReview&&t.business.FareReview.contactInformation&&t.business.FareReview.contactInformation.Email?t.business.FareReview.contactInformation.Email:""},this.isRetrievePage=function(){var t=e.getPage();return t.match(/rtpl|conf|rconf|mconf/gi)},this.isOnlinePnr=function(){return new RegExp(/(^.{5}08[A-Z]{2})/gi).test(e.getInitialOfficeId())},this.getDepartureCountryCode=function(){try{return e.getJson().bound[0].dep_country}catch(t){e.warn("Departure country code not found")}return""},this.getInitialOfficeId=function(){return"undefined"!=typeof e.getJson().initial_office_id?e.getJson().initial_office_id:(e.warn("Initial office Id not found"),"")},this.getCurrency=function(){return e.getJson().currency},this.getInitialOfficeCity=function(){var t=e.getInitialOfficeId();return t.length>3?t.substr(0,3).toUpperCase():""},this.getPnrNumber=function(){var t=e.getJson();return t&&t.pnr_number?t.pnr_number:""},this.getPageData=function(){return plnextv2.utils.context.AppContext.getPageData()},this.initOfficeIdMapping=function(e){this.officeIdMapping=e},this._getOfficeId=function(t){return e.isOnlinePnr()?e.getInitialOfficeId():0==e.officeIdMapping.length?(e.warn("The office Id mapping is not defined"),null):!t in this.officeIdMapping?(e.warn("The key "+t+" is not present in the mapping"),null):e.officeIdMapping[t]},this.getOfficeIdByDepartureCountry=function(){return e._getOfficeId(e.getDepartureCountryCode())},this.getOfficeIdByCurrency=function(){return e._getOfficeId(e.getCurrency())},this.getOfficeIdByInitialOfficeCity=function(){return e._getOfficeId(e.getInitialOfficeCity())},this.getOfficeIdByInitialOfficeId=function(){return e._getOfficeId(e.getInitialOfficeId())},this.initPosMapping=function(t){e.posMapping=t},this._getPos=function(t){return 0==e.posMapping.length?(e.warn("The pos / pot mapping is not defined"),null):!t in e.posMapping?(e.warn("The key "+t+" is not present in the pos mapping"),null):e.posMapping[t]},this.getPosByCurrency=function(){return e._getPos(e.getCurrency())},this.getPosByDepartureCountry=function(){return e._getPos(e.getDepartureCountryCode())},this.getPosByInitialOfficeCity=function(){return this._getPos(e.getInitialOfficeCity())},this.getPosByInitialOfficeId=function(){return e._getPos(e.getInitialOfficeId())},this.getOverrideParameterValues=function(t){var n={};if("undefined"!=typeof t){if(t.office){var i=null;t.office.toUpperCase()==e.BY_DEPARTURE_COUNTRY?i=e.getOfficeIdByDepartureCountry():t.office.toUpperCase()==e.BY_CURRENCY?i=e.getOfficeIdByCurrency():t.office.toUpperCase()==e.BY_INITIAL_OFFICE_CITY?i=e.getOfficeIdByInitialOfficeCity():t.office.toUpperCase()==e.BY_INITIAL_OFFICE_ID&&(i=e.getOfficeIdByInitialOfficeId()),null!=i&&(n.SO_SITE_OFFICE_ID=i)}if(t.pos){var o=null;t.pos.toUpperCase()==e.BY_DEPARTURE_COUNTRY?i=e.getPosByDepartureCountry():t.pos.toUpperCase()==e.BY_CURRENCY?o=e.getPosByCurrency():t.pos.toUpperCase()==e.BY_INITIAL_OFFICE_CITY?o=e.getPosByInitialOfficeCity():t.pos.toUpperCase()==e.BY_INITIAL_OFFICE_ID&&(i=e.getPosByInitialOfficeId()),null!=o&&(n.SO_SITE_POINT_OF_SALE=o,n.SO_SITE_POINT_OF_TICKETING=o)}if(t.other&&"object"==typeof t.other)for(key in t.other)t.other.hasOwnProperty(key)&&(n[key]=t.other[key])}return n},this.launchModifyPassengers=function(e){e&&e.preventDefault&&e.preventDefault(),jQuery(".travellers-panel-footer button").click()}}var implibdx=implibdx||{};implibdx.core=new IMPLibDxCore,jQuery(document).ready(function(){implibdx.core.isCustomJavascriptEnabled()&&implibdx.custom&&(implibdx.custom.onDomReady&&implibdx.custom.onDomReady(),jQuery(document).on(implibdx.core.JSON_READY_EVENT,function(){implibdx.custom.onJsonReady&&implibdx.custom.onJsonReady()}))});